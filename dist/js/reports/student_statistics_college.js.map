{"version":3,"sources":["../../../js/reports/student_statistics_college.js"],"names":["$","makeReportQuery","year","term","get","url","serverURL","beforeSend","data","InternationalStudentStatisticsByCollege","CollegeStudentStatisticsReport","props","state","colleges","error","fetchReport","bind","setState","done","fail","toString","parseInt","CollegeStudentStatisticsTable","totalGradSchool","totalUnderGradSchool","grandTotal","forEach","gradSchool","college","graduate_students","underGradSchool","undergrad_students","collegeTotal","rows","map","index","CollegeStudentStatisticsRow","percentage","toFixed","CollegeStudentStatisticsChart","name","abbreviation","Graduate","Undergraduate"],"mappings":"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","file":"student_statistics_college.js","sourcesContent":["import React, { Component } from \"react\";\nimport * as $ from \"jquery\";\nimport settings from \"../settings\";\nimport authorizeXHR from \"../authorization\";\nimport {\n    EndOfReportIndicator,\n    GenericYearTermReport,\n    ReportHead,\n    ReportTitleContainer,\n} from \"../components/reports\";\nimport ErrorState from \"../components/error_state\";\nimport LoadingSpinner from \"../components/loading\";\nimport { Table } from \"reactstrap\";\nimport {\n    BarChart,\n    Bar,\n    XAxis,\n    YAxis,\n    Legend,\n} from \"recharts\";\n\n\nfunction makeReportQuery(year, term) {\n    return $.get({\n        url : `${settings.serverURL}/reports/inbound-statistics-reports/`,\n        beforeSend : authorizeXHR,\n        data : {\n            \"filter\" : \"college\",\n            \"academic-year\" : year,\n            \"term\" : term,\n        },\n    });\n}\n\nclass InternationalStudentStatisticsByCollege extends GenericYearTermReport {\n    report(year, term) {\n        return <CollegeStudentStatisticsReport year={ year }\n                                               term={ term }/>;\n    }\n}\n\nclass CollegeStudentStatisticsReport extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            colleges : null,\n            error : null,\n        };\n\n        this.fetchReport = this.fetchReport.bind(this);\n        this.fetchReport(this.props.year, this.props.term);\n    }\n\n    fetchReport(year, term) {\n        if (this.state.error) {\n            this.setState({\n                error : null,\n            });\n        }\n\n        makeReportQuery(year, term)\n            .done(colleges => this.setState({\n                colleges : colleges,\n            }))\n            .fail(() => this.setState({\n                error : \"AJAX Error at fetchReport()\",\n            }));\n    }\n\n    componentWillReceiveProps(props) {\n        this.setState({\n            colleges : null,\n        });\n\n        this.fetchReport(props.year, props.term);\n    }\n\n    render() {\n        if (this.state.error) {\n            return (\n                <ErrorState onRetryButtonClick={ () => this.fetchReport(this.props.year, this.props.term) }>\n                    { this.state.error.toString() }\n                </ErrorState>\n            );\n        }\n\n        if (this.state.colleges === null) {\n            return <LoadingSpinner/>;\n        }\n\n        const year = parseInt(this.props.year);\n\n        return (\n            <div className=\"report-page\">\n                <ReportHead/>\n                <ReportTitleContainer>\n                    <h4>Distribution of International Students (IS) by College</h4>\n                    <h5>{ `Academic Year ${year} - ${year + 1} Term ${this.props.term}` }</h5>\n                </ReportTitleContainer>\n                <CollegeStudentStatisticsTable colleges={ this.state.colleges }/>\n                <CollegeStudentStatisticsChart colleges={ this.state.colleges }/>\n                <EndOfReportIndicator/>\n            </div>\n        );\n    }\n}\n\nclass CollegeStudentStatisticsTable extends Component {\n    render() {\n        let totalGradSchool = 0;\n        let totalUnderGradSchool = 0;\n        let grandTotal = 0;\n\n        this.props.colleges.forEach(college => {\n            const gradSchool = college.graduate_students;\n            const underGradSchool = college.undergrad_students;\n            const collegeTotal = gradSchool + underGradSchool;\n\n            totalGradSchool += gradSchool;\n            totalUnderGradSchool += underGradSchool;\n            grandTotal += collegeTotal;\n        });\n\n        const rows = this.props.colleges.map((college, index) =>\n            <CollegeStudentStatisticsRow key={ index }\n                                         college={ college }\n                                         grandTotal={ grandTotal }/>,\n        );\n\n        return (\n            <Table>\n                <thead>\n                <tr className=\"text-center\">\n                    <th>College</th>\n                    <th>Graduate Students</th>\n                    <th>Undergraduate Students</th>\n                    <th>Total Students</th>\n                    <th>Percentage to Total IS</th>\n                </tr>\n                </thead>\n                <tbody>\n                { rows }\n                </tbody>\n                <tfoot className=\"text-right\">\n                <tr>\n                    <th>Total</th>\n                    <th className=\"numeric\">{ totalGradSchool }</th>\n                    <th className=\"numeric\">{ totalUnderGradSchool }</th>\n                    <th className=\"numeric\">{ grandTotal }</th>\n                    <th className=\"numeric\">100%</th>\n                </tr>\n                </tfoot>\n            </Table>\n        );\n    }\n}\n\nclass CollegeStudentStatisticsRow extends Component {\n    render() {\n        const gradSchool = this.props.college.graduate_students;\n        const underGradSchool = this.props.college.undergrad_students;\n        const collegeTotal = gradSchool + underGradSchool;\n\n        let percentage = 0;\n\n        if (this.props.grandTotal !== 0) {\n            percentage = (collegeTotal * 100 / this.props.grandTotal).toFixed(1);\n        }\n\n        return (\n            <tr>\n                <td>{ this.props.college.college }</td>\n                <td className=\"numeric text-right\">{ gradSchool }</td>\n                <td className=\"numeric text-right\">{ underGradSchool }</td>\n                <td className=\"numeric text-right\">{ collegeTotal }</td>\n                <td className=\"numeric text-right\">{ percentage }%</td>\n            </tr>\n        );\n    }\n}\n\nclass CollegeStudentStatisticsChart extends Component {\n    render() {\n        const data = this.props.colleges.map(college => {\n            return {\n                name : college.abbreviation,\n                Graduate : college.graduate_students,\n                Undergraduate: college.undergrad_students\n            };\n        });\n\n        return (\n            <div className=\"mt-5 d-flex justify-content-center\">\n                <BarChart width={ 560 } height={ 240 } data={ data }>\n                    <XAxis dataKey=\"name\"/>\n                    <YAxis/>\n                    <Legend/>\n                    <Bar dataKey=\"Graduate\" stackId=\"a\" fill=\"#343a40\"/>\n                    <Bar dataKey=\"Undergraduate\" stackId=\"a\" fill=\"#00a357\"/>\n                </BarChart>\n            </div>\n        );\n    }\n}\n\nexport default InternationalStudentStatisticsByCollege;"]}