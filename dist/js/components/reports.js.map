{"version":3,"sources":["../../../js/components/reports.js"],"names":["ReportBar","props","children","window","print","YearAndTermReportBar","onActiveYearChange","bind","event","setActiveYear","target","value","academicYears","map","year","activeYear","setActiveTerm","activeTerm","ReportHead","dateGenerated","format","GenericYearTermReport","state","error","report","fetchYears","setState","then","result","academic_years","length","parseInt","academicYear","academic_year_start","catch","term","toString","noAcademicYears","ReportTitleContainer","EndOfReportIndicator"],"mappings":"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","file":"reports.js","sourcesContent":["import React, { Component } from \"react\";\nimport {\n    Button,\n    ButtonGroup,\n    Form,\n    FormGroup,\n    Input,\n    Label,\n} from \"reactstrap\";\nimport moment from \"moment\";\nimport ErrorState from \"./error_state\";\nimport LoadingSpinner from \"./loading\";\nimport makeYearsQuery from \"../reports/academic_years_query\";\n\n\nclass ReportBar extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        return (\n            <div className=\"report-bar bg-dlsu-lighter d-flex flex-row p-3 pt-2 pb-2 align-items-center\">\n                <div className=\"mr-auto d-flex flex-row\">\n                    {this.props.children}\n                </div>\n                <div>\n                    <Button color=\"light\"\n                            onClick={() => window.print()}>Print report</Button>\n                </div>\n            </div>\n        );\n    }\n}\n\nclass YearAndTermReportBar extends Component {\n    constructor(props) {\n        super(props);\n\n        this.onActiveYearChange = this.onActiveYearChange.bind(this);\n    }\n\n    onActiveYearChange(event) {\n        this.props.setActiveYear(event.target.value);\n    }\n\n    render() {\n        const academicYears = this.props.academicYears.map(year =>\n            <option value={year}\n                    key={year}>{`${year} - ${year + 1}`}</option>,\n        );\n\n        return (\n            <ReportBar>\n                <Form inline>\n                    <FormGroup className=\"mr-4\">\n                        <Label for=\"academic-year\"\n                               className=\"text-white mr-3\">Academic Year</Label>\n                        <Input type=\"select\"\n                               className=\"btn-outline-light\"\n                               value={this.props.activeYear}\n                               onChange={this.onActiveYearChange}>\n                            {academicYears}\n                        </Input>\n                    </FormGroup>\n\n                    <FormGroup>\n                        <Label for=\"term\"\n                               className=\"text-white mr-3\">Term</Label>\n                        <ButtonGroup>\n                            <Button outline\n                                    color=\"light\"\n                                    onClick={() => this.props.setActiveTerm(1)}\n                                    active={this.props.activeTerm === 1}>1</Button>\n                            <Button outline\n                                    color=\"light\"\n                                    onClick={() => this.props.setActiveTerm(2)}\n                                    active={this.props.activeTerm === 2}>2</Button>\n                            <Button outline\n                                    color=\"light\"\n                                    onClick={() => this.props.setActiveTerm(3)}\n                                    active={this.props.activeTerm === 3}>3</Button>\n                        </ButtonGroup>\n                    </FormGroup>\n                </Form>\n\n            </ReportBar>\n        );\n    }\n}\n\nclass ReportHead extends Component {\n    render() {\n        const dateGenerated = moment().format(\"LLL\");\n\n        return (\n            <div className=\"d-flex flex-row align-items-center\">\n                <div className=\"d-flex flex-row mr-auto align-items-center\">\n                    <img src=\"../images/dlsu_green.png\"\n                         className=\"report-dlsu-logo mr-2\"/>\n                    <div className=\"d-flex flex-column\">\n                        <div>External Relations and Internationalization Office</div>\n                        <div>De La Salle University Manila</div>\n                    </div>\n                </div>\n\n                <div className=\"d-flex flex-column text-right\">\n                    <div>Report Generated</div>\n                    <div>{dateGenerated}</div>\n                </div>\n            </div>\n        );\n    }\n}\n\nclass GenericYearTermReport extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            academicYears : null,\n            activeYear : null,\n            activeTerm : 1,\n            error : null,\n        };\n\n        this.report = this.report.bind(this);\n        this.fetchYears = this.fetchYears.bind(this);\n        this.setActiveYear = this.setActiveYear.bind(this);\n        this.setActiveTerm = this.setActiveTerm.bind(this);\n\n        this.fetchYears();\n    }\n\n    fetchYears() {\n        if (this.state.error) {\n            this.setState({\n                error : null,\n            });\n        }\n\n        makeYearsQuery()\n            .then(result => {\n                if (result.academic_years.length === 0) {\n                    this.setState({\n                        academicYears : [],\n                    });\n\n                    return;\n                }\n\n                const academicYears = result.academic_years.map(academicYear =>\n                    parseInt(academicYear.academic_year_start),\n                );\n\n                const activeYear = academicYears[0];\n\n                this.setState({\n                    activeYear : activeYear,\n                    academicYears : academicYears,\n                });\n            })\n            .catch(error => this.setState({\n                error : error,\n            }));\n    }\n\n    setActiveYear(year) {\n        this.setState({\n            activeYear : year,\n        });\n    }\n\n    setActiveTerm(term) {\n        this.setState({\n            activeTerm : term,\n        });\n    }\n\n    static noAcademicYears() {\n        return (\n            <div className=\"loading-container\">\n                <h3>There are no academic years found.</h3>\n                <p>Reports are grouped by academic year terms. Add academic years to generate reports.</p>\n            </div>\n        );\n    }\n\n    report(year, term) {\n        return null;\n    }\n\n    render() {\n        if (this.state.error) {\n            return (\n                <ErrorState onRetryButtonClick={this.fetchYears}>\n                    {this.state.error.toString()}\n                </ErrorState>\n            );\n        }\n\n        if (this.state.academicYears === null) {\n            return <LoadingSpinner/>;\n        }\n\n        if (this.state.academicYears.length === 0) {\n            return GenericYearTermReport.noAcademicYears();\n        }\n\n        return (\n            <div>\n                <YearAndTermReportBar\n                    academicYears={this.state.academicYears}\n                    activeYear={this.state.activeYear}\n                    activeTerm={this.state.activeTerm}\n                    setActiveYear={this.setActiveYear}\n                    setActiveTerm={this.setActiveTerm}/>\n\n                {this.report(this.state.activeYear, this.state.activeTerm)}\n            </div>\n        );\n    }\n}\n\nclass ReportTitleContainer extends Component {\n    render() {\n        return (\n            <div className=\"d-flex flex-column align-items-center justify-content-center p-5\">\n                {this.props.children}\n            </div>\n        );\n    }\n}\n\nclass EndOfReportIndicator extends Component {\n    render() {\n        return (\n            <div className=\"w-100 text-center p-5\">\n                <small className=\"font-weight-bold text-uppercase text-muted\">End of Report</small>\n            </div>\n        );\n    }\n}\n\nexport {\n    ReportBar,\n    ReportHead,\n    ReportTitleContainer,\n    GenericYearTermReport,\n    YearAndTermReportBar,\n    EndOfReportIndicator,\n};"]}