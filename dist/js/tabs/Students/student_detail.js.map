{"version":3,"sources":["../../../../js/tabs/Students/student_detail.js"],"names":["fetchStudent","id","onResult","query","then","StudentDetail","props","state","student","studentID","onEditStudent","bind","setState","result","refreshStudents","nextProps","unselectedState","onDeleteActiveStudent","StudentDetailHead","deleteStudentIsShowing","editStudentIsShowing","toggleDeleteStudent","toggleEditStudent","first_name","middle_name","family_name","id_number","onDeleteStudent","StudentDetailBody"],"mappings":"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","file":"student_detail.js","sourcesContent":["import React, { Component } from \"react\";\nimport {\n    Button,\n} from \"reactstrap\";\nimport {\n    StudentDetailOverview,\n    StudentContact,\n    StudentUniversity,\n\n} from \"./student_detail_overview\";\nimport {\n    DeleteStudentModal,\n    StudentFormModal,\n\n} from \"./modals\";\nimport LoadingSpinner from \"../../components/loading\";\nimport graphql from \"../../graphql\";\n\n\nfunction fetchStudent(id, onResult) {\n    graphql.query(`\n    {\n        student(id:${id}) {\n            id\n            category\n            id_number\n            college\n            family_name\n            first_name\n            middle_name\n            nickname\n            nationality\n            home_address\n            phone_number\n            birth_date\n            sex\n            emergency_contact_name\n            emergency_contact_relationship\n            emergency_contact_number\n            email\n            civil_status\n            institution {\n                id\n                name\n            }\n        }\n    }\n    `).then(onResult);\n}\n\nclass StudentDetail extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            student : null,\n            studentID : null,\n        };\n\n        this.onEditStudent = this.onEditStudent.bind(this);\n    }\n\n    static unselectedState() {\n        return (\n            <div className=\"loading-container\">\n                <h3>Select a student to see its details</h3>\n            </div>\n        );\n    }\n\n    onEditStudent() {\n        this.setState({\n            student : null,\n        });\n\n        fetchStudent(this.state.studentID, result => {\n            const student = result.student;\n            this.setState({\n                student : student,\n            });\n            this.props.refreshStudents();\n        });\n    }\n\n    componentWillReceiveProps(nextProps) {\n        const student = nextProps.student;\n\n        if (student === null) {\n            this.setState({\n                student : null,\n                studentID : null,\n            });\n\n            return;\n        }\n\n        this.setState({\n            studentID : student.id,\n            student : null,\n        });\n\n        fetchStudent(student.id, result => {\n            this.setState({\n                student : result.student,\n            });\n        });\n    }\n\n    render() {\n        if (this.state.studentID === null) {\n            return StudentDetail.unselectedState();\n        }\n\n        if (this.state.student === null) {\n            return <LoadingSpinner/>;\n        }\n\n        return (\n            <div id=\"student-detail\" className=\"container-fluid d-flex flex-column p-0\">\n                <StudentDetailHead student={this.state.student}\n                                   onEditStudent={this.onEditStudent}\n                                   onDeleteStudent={this.props.onDeleteActiveStudent}/>\n                <StudentDetailBody student={this.state.student}/>\n            </div>\n        );\n    }\n}\n\nclass StudentDetailHead extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            deleteStudentIsShowing : false,\n            editStudentIsShowing : false,\n        };\n\n        this.toggleDeleteStudent = this.toggleDeleteStudent.bind(this);\n        this.toggleEditStudent = this.toggleEditStudent.bind(this);\n    }\n\n    toggleDeleteStudent() {\n        this.setState({\n            deleteStudentIsShowing : !this.state.deleteStudentIsShowing,\n        });\n    }\n\n    toggleEditStudent() {\n        this.setState({\n            editStudentIsShowing : !this.state.editStudentIsShowing,\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"page-head pt-5 d-flex flex-row align-items-center\">\n                <div className=\"mr-auto\">\n                    <h4 className=\"page-head-title justify-content-left d-inline-block mb-0 mr-2\">\n                        {this.props.student.first_name} {this.props.student.middle_name} {this.props.student.family_name}\n                        <small className=\"text-muted ml-2\">{this.props.student.id_number}</small>\n                    </h4>\n                </div>\n\n                <div className=\"page-head-actions\">\n                    <Button outline size=\"sm\"\n                            color=\"success\"\n                            className=\"mr-2\" onClick={this.toggleEditStudent}>\n                        Edit Student\n                    </Button>\n\n                    <Button outline size=\"sm\" color=\"danger\" onClick={this.toggleDeleteStudent}>Delete</Button>\n                </div>\n\n                <DeleteStudentModal isOpen={this.state.deleteStudentIsShowing}\n                                    student={this.props.student}\n                                    toggle={this.toggleDeleteStudent}\n                                    refresh={this.props.onDeleteStudent}/>\n\n                <StudentFormModal edit\n                                  isOpen={this.state.editStudentIsShowing}\n                                  student={this.props.student}\n                                  refresh={this.props.onEditStudent}\n                                  toggle={this.toggleEditStudent}/>\n            </div>\n        );\n    }\n}\n\nclass StudentDetailBody extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        return (\n            <div className=\"page-body\">\n                <StudentDetailOverview student={this.props.student}/>\n                <StudentContact student={this.props.student}/>\n                <StudentUniversity student={this.props.student}/>\n            </div>\n        );\n    }\n}\n\nexport default StudentDetail;"]}