{"version":3,"sources":["../../../../js/tabs/Students/students.js"],"names":["tabs","name","image","activeImage","makeStudentsQuery","category","query","Students","props","state","allStudents","activeStudent","activeTab","error","onAddStudent","bind","setActiveTab","fetchStudents","setActiveStudent","onArchiveActiveStudent","tabName","setState","then","result","students","catch","tab","student","toString","refresh"],"mappings":"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","file":"students.js","sourcesContent":["import React, { Component } from \"react\";\nimport graphql from \"../../graphql\";\nimport StudentList from \"./student_list\";\nimport StudentDetail from \"./student_detail\";\nimport { StudentFormModal, } from \"./modals\";\nimport ErrorState from \"../../components/error_state\";\n\n\nconst tabs = [\n    {\n        name : \"Inbound\",\n        image : \"./images/inboundgrey.png\",\n        activeImage : \"./images/inboundgreen.png\",\n    },\n    {\n        name : \"Outbound\",\n        image : \"./images/airplanegrey.png\",\n        activeImage : \"./images/airplanegreen.png\",\n    },\n];\n\n\nfunction makeStudentsQuery(category) {\n    return graphql.query(`\n    {\n        students(category:\"${category}\") {\n            id\n            id_number\n            family_name\n            first_name\n            middle_name\n        }\n    }\n    `);\n}\n\nclass Students extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            allStudents : null,\n            activeStudent : null,\n            activeTab : tabs[0],\n            error : null,\n        };\n\n        this.onAddStudent = this.onAddStudent.bind(this);\n        this.setActiveTab = this.setActiveTab.bind(this);\n        this.fetchStudents = this.fetchStudents.bind(this);\n        this.setActiveStudent = this.setActiveStudent.bind(this);\n        this.onArchiveActiveStudent = this.onArchiveActiveStudent.bind(this);\n\n        this.fetchStudents(this.state.activeTab.name);\n    }\n\n    fetchStudents(tabName) {\n        const category = tabName === \"Inbound\" ? \"IN\" : \"OUT\";\n\n        if (this.state.error) {\n            this.setState({\n                error : null,\n            });\n        }\n\n        makeStudentsQuery(category)\n            .then(result => this.setState({\n                allStudents : result.students,\n            }))\n            .catch(error => this.setState({\n                error : error,\n            }));\n    }\n\n    setActiveTab(tab) {\n        this.setState({\n            activeTab : tab,\n            activeStudent : null, //Student is no longer in the same category\n            allStudents : null,\n        });\n\n        this.fetchStudents(tab.name);\n    }\n\n    onAddStudent(student) {\n        // Only set new student as active if user is currently looking at inbounds\n        // Only inbound because the only type of student you can add here is inbound\n        if (this.state.tab.name === \"Inbound\") {\n            this.setState({\n                activeStudent : student,\n            });\n        }\n    }\n\n    onArchiveActiveStudent() {\n        this.setState({\n            activeStudent : null,\n        });\n\n        // Refresh students\n        this.fetchStudents(this.state.activeTab.name);\n    }\n\n    setActiveStudent(student) {\n        this.setState({\n            activeStudent : student,\n        });\n    }\n\n    render() {\n        if (this.state.error) {\n            return (\n                <ErrorState onRetryButtonClick={() => this.fetchStudents(this.state.activeTab.name)}>\n                    {this.state.error.toString()}\n                </ErrorState>\n            );\n        }\n\n        const refresh = () => this.fetchStudents(this.state.activeTab.name);\n\n        return (\n            <div className=\"container-fluid d-flex flex-row p-0 h-100\">\n                <StudentList students={this.state.allStudents}\n                             activeStudent={this.state.activeStudent}\n                             setActiveStudent={this.setActiveStudent}\n                             setActiveTab={this.setActiveTab}\n                             activeTab={this.state.activeTab}\n                             tabs={tabs}/>\n                <StudentDetail student={this.state.activeStudent}\n                               onArchiveActiveStudent={this.onArchiveActiveStudent}\n                               refreshStudents={refresh}/>\n            </div>\n        );\n    }\n}\n\nexport default Students;"]}