{"version":3,"sources":["../../../../../js/tabs/Archives/tabs/memorandums.js"],"names":["fetchMemorandums","year","onResult","query","then","MemorandumArchives","props","state","activeYear","memorandums","activeMemorandumId","setCurrentYear","bind","refreshMemorandums","setActiveMemorandum","setState","result","memorandum","id","setSidebarContent","MemorandumArchivesHead","onCurrentYearChange","event","target","value","years","currentYear","i","push","MemorandumArchivesTable","length","emptyState","rows","map","index","MemorandumArchivesRow","memorandumType","category","dateEffective","date_effective","format","archiveDate","archived_at","className","isActive","onClick","institution","name","archiver"],"mappings":"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","file":"memorandums.js","sourcesContent":["import React, { Component } from \"react\";\nimport graphql from \"../../../graphql\";\nimport moment from \"moment\";\nimport {\n    Input,\n    Table,\n} from \"reactstrap\";\nimport LoadingSpinner from \"../../../components/loading\";\nimport { MemorandumSidebarPane } from \"../../Institutions/tabs/sidebar_panes\";\n\n\nfunction fetchMemorandums(year, onResult) {\n    graphql.query(`\n    {\n        memorandums(archived:true, year_archived:${year}) {\n\t\tid\n\t\tcategory\n\t\tarchived_at\n\t\tarchiver\n\t\tmemorandum_file\n        date_expiration\n        college_initiator\n        linkages\n\t\tdate_effective\n            institution {\n                name\n            }\n\t\t}\n\t}\n\t`).then(onResult);\n}\n\nclass MemorandumArchives extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            activeYear : moment().year(),\n            memorandums : null,\n            activeMemorandumId : null,\n        };\n\n        this.setCurrentYear = this.setCurrentYear.bind(this);\n        this.refreshMemorandums = this.refreshMemorandums.bind(this);\n        this.setActiveMemorandum = this.setActiveMemorandum.bind(this);\n\n        fetchMemorandums(this.state.activeYear, result => {\n            this.setState({\n                memorandums : result.memorandums,\n            });\n        });\n    }\n\n    setActiveMemorandum(memorandum) {\n        this.setState({\n            activeMemorandumId : memorandum.id,\n        });\n\n        this.props.setSidebarContent(<MemorandumSidebarPane archived\n                                                            onRestoreSuccess={this.refreshMemorandums}\n                                                            memorandum={memorandum}/>);\n    }\n\n\n    setCurrentYear(year) {\n        this.setState({\n            activeYear : year,\n            activeMemorandumId : null,\n            memorandums : null, //Loading\n        });\n\n        this.props.setSidebarContent(null);\n\n        fetchMemorandums(year, result => {\n            this.setState({\n                memorandums : result.memorandums,\n            });\n        });\n    }\n\n    refreshMemorandums() {\n        this.setCurrentYear(this.state.activeYear);\n    }\n\n    render() {\n        return (\n            <div className=\"d-flex flex-column h-100\">\n                <MemorandumArchivesHead setCurrentYear={this.setCurrentYear}\n                                        activeYear={this.state.activeYear}/>\n                <MemorandumArchivesTable memorandums={this.state.memorandums}\n                                         setSidebarContent={this.props.setSidebarContent}\n                                         activeMemorandumId={this.state.activeMemorandumId}\n                                         setActiveMemorandum={this.setActiveMemorandum}/>\n            </div>\n        );\n    }\n}\n\nclass MemorandumArchivesHead extends Component {\n    constructor(props) {\n        super(props);\n        this.onCurrentYearChange = this.onCurrentYearChange.bind(this);\n    }\n\n    onCurrentYearChange(event) {\n        this.props.setCurrentYear(event.target.value);\n    }\n\n    render() {\n        const years = [];\n        const currentYear = moment().year();\n\n        //Create options for years 100 years from current year\n        for (let i = 0; i <= 100; i++) {\n            const year = currentYear - i;\n            years.push(<option value={year}\n                               key={i}>{year}</option>);\n        }\n\n\n        return (\n            <div className=\"page-head pt-5 d-flex flex-row align-items-end\">\n                <div className=\"mr-auto\">\n                    <h4 className=\"page-head-title justify-content-left d-inline-block mb-0 mr-2\">\n                        Memorandum Archives\n                    </h4>\n                </div>\n\n                <div className=\"page-head-actions\">\n                    <div className=\"d-flex flex-row align-items-center\">\n                        <b className=\"mr-3\">Year</b>\n                        <Input type=\"select\"\n                               className=\"btn-outline-success\"\n                               defaultValue={this.props.activeYear}\n                               onChange={this.onCurrentYearChange}>\n                            {years}\n                        </Input>\n                    </div>\n                </div>\n\n            </div>\n        );\n    }\n}\n\nclass MemorandumArchivesTable extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    static emptyState() {\n        return (\n            <div className=\"loading-container\">\n                <h3>There are no archived memorandums for this year</h3>\n            </div>\n        );\n    }\n\n    render() {\n        if (this.props.memorandums === null) {\n            return <LoadingSpinner/>;\n        }\n\n        if (this.props.memorandums.length === 0) {\n            return MemorandumArchivesTable.emptyState();\n        }\n\n        const rows = this.props.memorandums.map((memorandum, index) => {\n            return <MemorandumArchivesRow memorandum={memorandum}\n                                          key={index}\n                                          isActive={this.props.activeMemorandumId === memorandum.id}\n                                          onClick={() => this.props.setActiveMemorandum(memorandum)}/>;\n        });\n\n\n        return (\n            <Table striped\n                   hover>\n                <thead>\n                <tr>\n                    <th>Institution Name</th>\n                    <th>Memorandum Type</th>\n                    <th>Date Effective</th>\n                    <th>Archive Date</th>\n                    <th>Archived By</th>\n                </tr>\n                </thead>\n                <tbody>\n                {rows}\n                </tbody>\n            </Table>\n        );\n    }\n}\n\nclass MemorandumArchivesRow extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        const memorandumType = this.props.memorandum.category === \"MOA\" ? \"Agreement\" : \"Understanding\";\n        const dateEffective = moment(this.props.memorandum.date_effective).format(\"LL\");\n        const archiveDate = moment(this.props.memorandum.archived_at).format(\"LLL\");\n\n        const className = this.props.isActive ? \"bg-dlsu-lighter text-white\" : null;\n\n        return (\n            <tr className={className}\n                onClick={this.props.onClick}>\n                <td>{this.props.memorandum.institution.name}</td>\n                <td>{memorandumType}</td>\n                <td>{dateEffective}</td>\n                <td>{archiveDate}</td>\n                <td>{this.props.memorandum.archiver}</td>\n            </tr>\n        );\n    }\n}\n\nexport default MemorandumArchives;"]}