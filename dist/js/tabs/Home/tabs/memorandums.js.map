{"version":3,"sources":["../../../../../js/tabs/Home/tabs/memorandums.js"],"names":["fetchInstitutions","onResponse","query","makeCardInfo","memorandumType","institution","memorandum","name","id","type","dateEffective","date_effective","dateExpiration","date_expiration","makeCardsFromInstitution","institutions","cards","forEach","latest_mou","push","latest_moa","sort","a","b","diff","Memorandums","props","state","response","data","setState","length","emptyState","map","card","index","MemorandumCard","format","expirationToNow","fromNow","now","dateExpirationMoment","monthsBeforeExpiration","hasExpired","urgent","className","undefined"],"mappings":"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","file":"memorandums.js","sourcesContent":["import React, { Component } from \"react\";\nimport graphql from \"../../../graphql\";\nimport moment from \"moment\";\n\nimport {\n    Card,\n    CardBody,\n} from \"reactstrap\";\n\nimport {\n    SectionRow,\n    SectionRowContent,\n    SectionRowTitle,\n} from \"../../../components/section\";\nimport LoadingSpinner from \"../../../loading\";\n\n\nfunction fetchInstitutions(onResponse) {\n    graphql({\n        query : `\n                {\n                  institutions {\n                    id\n                    name\n                        latest_mou {\n                            date_effective\n                            date_expiration\n                        }\n                        latest_moa {\n                            date_effective\n                            date_expiration\n                        }\n                  }\n                }\n        `,\n        onResponse : onResponse,\n    });\n}\n\nfunction makeCardInfo(memorandumType, institution, memorandum) {\n    return {\n        institution : {\n            name : institution.name,\n            id : institution.id,\n        },\n        memorandum : {\n            type : memorandumType,\n            dateEffective : moment(memorandum.date_effective),\n            dateExpiration : moment(memorandum.date_expiration),\n        },\n    };\n}\n\nfunction makeCardsFromInstitution(institutions) {\n    let cards = [];\n\n\n    institutions.forEach(institution => {\n        if (institution.latest_mou !== null && institution.latest_mou.date_expiration !== null) {\n            cards.push(makeCardInfo(\"Understanding\", institution, institution.latest_mou));\n        }\n\n        if (institution.latest_moa !== null && institution.latest_moa.date_expiration !== null) {\n            cards.push(makeCardInfo(\"Agreement\", institution, institution.latest_moa));\n        }\n    });\n\n\n    cards.sort((a, b) => {\n        return a.memorandum.dateExpiration.diff(b.memorandum.dateExpiration);\n    });\n\n    return cards;\n}\n\nclass Memorandums extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            cards : null,\n        };\n\n        fetchInstitutions(response => {\n            const institutions = response.data.institutions;\n            this.setState({\n                cards : makeCardsFromInstitution(institutions),\n            });\n        });\n    }\n\n    static emptyState() {\n        return (\n            <h5>There are no memorandums found with an expiration date</h5>\n        );\n    }\n\n    render() {\n\n        if (this.state.cards === null) {\n            return <LoadingSpinner/>;\n        }\n\n        if (this.state.cards.length === 0) {\n            return Memorandums.emptyState();\n        }\n\n        const cards = this.state.cards.map((card, index) => {\n            return <MemorandumCard key={index} card={card}/>;\n        });\n\n        return (\n            <div className=\"d-flex flex-column align-items-center page-body p-4\">\n                {cards}\n            </div>\n        );\n    }\n}\n\nclass MemorandumCard extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n\n        const dateEffective = this.props.card.memorandum.dateEffective.format(\"LL\");\n        const dateExpiration = this.props.card.memorandum.dateExpiration.format(\"LL\");\n        const expirationToNow = this.props.card.memorandum.dateExpiration.fromNow();\n\n\n        const now = moment();\n        const dateExpirationMoment = this.props.card.memorandum.dateExpiration;\n        const monthsBeforeExpiration = dateExpirationMoment.diff(now, \"months\");\n        const hasExpired = dateExpirationMoment.diff(now, \"days\") <= 0;\n\n        const urgent = monthsBeforeExpiration <= 6;\n\n        let className = undefined;\n        if (urgent) {\n            className = \"bg-danger text-white\";\n        } else {\n            className = \"bg-primary text-white\";\n        }\n\n        return (\n            <Card className=\"home-card mt-4 rounded\">\n                <SectionRow className={className}>\n                    <SectionRowContent large>{hasExpired ? \"Expired \" : \"Expires in\"} {expirationToNow}</SectionRowContent>\n                </SectionRow>\n                <SectionRow>\n                    <SectionRowTitle>Institution Name</SectionRowTitle>\n                    <SectionRowContent large>{this.props.card.institution.name}</SectionRowContent>\n                </SectionRow>\n                <SectionRow>\n                    <SectionRowTitle>Memorandum Type</SectionRowTitle>\n                    <SectionRowContent large>{this.props.card.memorandum.type}</SectionRowContent>\n                </SectionRow>\n                <SectionRow>\n                    <SectionRowTitle>Date Effective</SectionRowTitle>\n                    <SectionRowContent>{dateEffective}</SectionRowContent>\n                </SectionRow>\n                <SectionRow>\n                    <SectionRowTitle>Date of Expiration</SectionRowTitle>\n                    <SectionRowContent>{dateExpiration}</SectionRowContent>\n                </SectionRow>\n            </Card>\n        );\n    }\n}\n\nexport default Memorandums;"]}