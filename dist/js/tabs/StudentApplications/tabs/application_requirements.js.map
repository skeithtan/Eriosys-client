{"version":3,"sources":["../../../../../js/tabs/StudentApplications/tabs/application_requirements.js"],"names":["makeRequirementsQuery","isInbound","query","makeInboundApplicationQuery","id","makeOutboundApplicationQuery","ApplicationRequirements","props","state","applicantRequirements","requirements","errors","fetchRequirements","bind","inbound","student","studentId","error","setState","then","result","inbound_requirements","outbound_requirements","catch","inboundstudentprogram","application_requirements","map","requirement","outboundstudentprogram","console","log","toString","ApplicationHead","first_name","middle_name","family_name","id_number","RequirementsBody","rows","includes","RequirementRow","done","name"],"mappings":"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","file":"application_requirements.js","sourcesContent":["import React, { Component } from \"react\";\nimport graphql from \"../../../graphql\";\nimport ErrorState from \"../../../components/error_state\";\nimport LoadingSpinner from \"../../../components/loading\";\nimport {\n    SectionRow,\n    SectionTable,\n} from \"../../../components/section\";\nimport { Button } from \"reactstrap\";\n\n\nfunction makeRequirementsQuery(isInbound) {\n    return graphql.query(`\n    {\n        ${isInbound ? \"inbound_requirements\" : \"outbound_requirements\"} {\n            id\n            name\n        }\n    }\n    `);\n}\n\nfunction makeInboundApplicationQuery(id) {\n    return graphql.query(`\n    {\n      student(id:${id}) {\n                inboundstudentprogram {\n                    application_requirements {\n                        id\n                    }\n                }\n        }\n    }\n    `);\n}\n\nfunction makeOutboundApplicationQuery(id) {\n    return graphql.query(`\n    {\n      student(id:${id}) {\n                outboundstudentprogram {\n                    application_requirements {\n                        id\n                    }\n                }\n        }\n    }\n    `);\n}\n\nclass ApplicationRequirements extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            applicantRequirements : null,\n            requirements : null,\n            errors : null,\n        };\n\n        this.fetchRequirements = this.fetchRequirements.bind(this);\n        this.fetchRequirements(props.inbound, props.student.id);\n    }\n\n    fetchRequirements(inbound, studentId) {\n        if (this.state.error) {\n            this.setState({\n                error : null,\n            });\n        }\n\n        makeRequirementsQuery(inbound)\n            .then(result => this.setState({\n                requirements : inbound ? result.inbound_requirements : result.outbound_requirements,\n            }))\n            .catch(error => this.setState({\n                error : error,\n            }));\n\n        if (inbound) {\n            makeInboundApplicationQuery(studentId)\n                .then(result => this.setState({\n                    applicantRequirements : result.student.inboundstudentprogram.application_requirements.map(requirement => requirement.id),\n                }))\n                .catch(error => this.setState({\n                    error : error,\n                }));\n        } else {\n            makeOutboundApplicationQuery(studentId)\n                .then(result => this.setState({\n                    applicantRequirements : result.student.outboundstudentprogram.application_requirements.map(requirement => requirement.id),\n                }))\n                .catch(error => this.setState({\n                    error : error,\n                }));\n        }\n    }\n\n    componentWillReceiveProps(props) {\n        this.setState({\n            applicantRequirements : null,\n        });\n\n        this.fetchRequirements(props.inbound, props.student.id);\n    }\n\n    render() {\n        console.log(this.state);\n\n        if (this.state.error) {\n            return (\n                <ErrorState onRetryButtonClick={() => this.fetchRequirements(this.props.inbound, this.props.student.id)}>\n                    {this.state.error.toString()}\n                </ErrorState>\n            );\n        }\n\n        if (this.state.applicantRequirements === null || this.state.requirements === null) {\n            return <LoadingSpinner/>;\n        }\n\n        return (\n            <div className=\"d-flex flex-column p-0 h-100\">\n                <ApplicationHead student={this.props.student}/>\n                <RequirementsBody requirements={this.state.requirements}\n                                  applicantRequirements={this.state.applicantRequirements}/>\n            </div>\n        );\n    }\n}\n\nclass ApplicationHead extends Component {\n    render() {\n        return (\n            <div className=\"page-head pt-5 d-flex flex-row align-items-center\">\n                <div className=\"mr-auto\">\n                    <h5 className=\"mb-0 text-secondary\">Application Requirements</h5>\n                    <h4 className=\"page-head-title justify-content-left d-inline-block mb-0 mr-2\">\n                        {this.props.student.first_name} {this.props.student.middle_name} {this.props.student.family_name}\n                        <small className=\"text-muted ml-2\">{this.props.student.id_number}</small>\n                    </h4>\n                </div>\n            </div>\n        );\n    }\n}\n\nclass RequirementsBody extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n\n        const rows = this.props.requirements.map(requirement =>\n            <RequirementRow key={requirement.id}\n                            done={this.props.applicantRequirements.includes(requirement.id)}\n                            requirement={requirement}/>,\n        );\n\n        return (\n            <SectionTable>\n                {rows}\n            </SectionTable>\n        );\n    }\n}\n\nclass RequirementRow extends Component {\n    render() {\n        return (\n            <SectionRow large\n                        className=\"d-flex flex-row align-items-center\">\n\n                {this.props.done &&\n                <b className=\"text-success\">âœ“</b>\n                }\n\n                <p className=\"lead mr-auto mb-0\">{this.props.requirement.name}</p>\n\n                {this.props.done &&\n                <Button outline\n                        color=\"warning\">Mark as undone</Button>\n                }\n\n                {!this.props.done &&\n                <Button outline\n                        color=\"success\">Mark as done</Button>\n                }\n            </SectionRow>\n        );\n    }\n}\n\nexport default ApplicationRequirements;"]}