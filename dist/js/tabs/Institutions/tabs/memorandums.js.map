{"version":3,"sources":["../../../../../js/tabs/Institutions/tabs/memorandums.js"],"names":["fetchInstitution","id","onResult","query","then","Memorandums","props","state","institution","institutionID","activeMemorandumId","refreshMemorandums","bind","setActiveMemorandum","setState","result","memorandum","setSidebarContent","onDeleteMemorandum","nextProps","memorandums","agreements","mous","understandings","moas","latestMOU","latest_mou","latestMOA","latest_moa","MemorandumHead","addMemorandumIsShowing","toggleAddMemorandum","name","MemorandumBody","MemorandumListSection","deleteMemorandumIsShowing","editMemorandumIsShowing","emptyState","toggleDeleteMemorandum","toggleEditMemorandum","children","length","rows","map","index","onMemorandumRowClick","isActive","MemorandumRow","formatDate","date","format","dateEffective","date_effective","onClick","latest"],"mappings":"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","file":"memorandums.js","sourcesContent":["import React, { Component } from \"react\";\nimport moment from \"moment\";\nimport graphql from \"../../../graphql\";\nimport LoadingSpinner from \"../../../components/loading\";\n\nimport { Button, } from \"reactstrap\";\n\nimport {\n    Section,\n    SectionTitle,\n    SectionTable,\n    SectionRow,\n    SectionRowContent,\n    SectionRowTitle,\n} from \"../../../components/section\";\n\nimport { MemorandumFormModal } from \"../modals\";\nimport { MemorandumSidebarPane } from \"./sidebar_panes\";\n\n\nfunction fetchInstitution(id, onResult) {\n    graphql.query(`\n    {\n      institution(id:${id}) {\n        id\n        name\n        moas {\n          id\n          category\n          memorandum_file\n          date_effective\n          date_expiration\n          college_initiator\n          linkages\n        }\n        mous {\n          id\n          category\n          memorandum_file\n          date_effective\n          date_expiration\n          college_initiator\n          linkages\n        }\n        \n      }\n    }\n    `).then(onResult);\n}\n\n\nclass Memorandums extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            institution : null,\n            institutionID : props.institution.id,\n            activeMemorandumId : null,\n        };\n\n        this.refreshMemorandums = this.refreshMemorandums.bind(this);\n        this.setActiveMemorandum = this.setActiveMemorandum.bind(this);\n\n        //Fetch active institution details\n        fetchInstitution(this.props.institution.id, result => {\n            this.setState({\n                institution : result.institution,\n            });\n        });\n    }\n\n    setActiveMemorandum(memorandum) {\n        if (memorandum === null) {\n            this.props.setSidebarContent(null);\n        }\n\n\n        const refreshMemorandums = () => {\n            this.refreshMemorandums();\n        };\n\n        const onDeleteMemorandum = () => {\n            this.setState({\n                activeMemorandumId : null,\n            });\n            this.refreshMemorandums();\n            this.setActiveMemorandum(null);\n        };\n\n\n        this.props.setSidebarContent(\n            <MemorandumSidebarPane memorandum={memorandum}\n                                   removeActiveMemorandum={onDeleteMemorandum}\n                                   refreshMemorandums={refreshMemorandums}/>,\n        );\n\n        this.setState({\n            activeMemorandumId : memorandum.id,\n        });\n    }\n\n    refreshMemorandums() {\n        this.setState({\n            institution : null,\n        });\n\n        fetchInstitution(this.props.institution.id, result => {\n            this.setState({\n                institution : result.institution,\n            });\n        });\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if (this.state.institutionID === nextProps.institution.id) {\n            return;\n        }\n\n        this.props.setSidebarContent(null);\n\n        this.setState({\n            institutionID : nextProps.institution.id,\n            institution : null,\n            activeMemorandumId : null //Remove current active memorandum ID\n        });\n\n        fetchInstitution(nextProps.institution.id, result => {\n            this.setState({\n                institution : result.institution,\n            });\n        });\n    }\n\n    render() {\n        if (this.state.institution === null) {\n            return <LoadingSpinner/>;\n        }\n\n        const memorandums = {\n            agreements : this.state.institution.mous,\n            understandings : this.state.institution.moas,\n            latestMOU : this.state.institution.latest_mou,\n            latestMOA : this.state.institution.latest_moa,\n        };\n\n        return (\n            <div className=\"d-flex flex-column p-0 h-100\">\n                <MemorandumHead institution={this.state.institution} refreshMemorandums={this.refreshMemorandums}/>\n                <MemorandumBody institution={this.state.institution}\n                                memorandums={memorandums}\n                                activeMemorandumId={this.state.activeMemorandumId}\n                                setActiveMemorandum={this.setActiveMemorandum}\n                                refreshMemorandums={this.refreshMemorandums}\n                                setSidebarContent={this.props.setSidebarContent}/>\n            </div>\n        );\n    }\n}\n\nclass MemorandumHead extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            addMemorandumIsShowing : false,\n        };\n\n        this.toggleAddMemorandum = this.toggleAddMemorandum.bind(this);\n    }\n\n    toggleAddMemorandum() {\n        this.setState({\n            addMemorandumIsShowing : !this.state.addMemorandumIsShowing,\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"page-head pt-5 d-flex flex-row align-items-end\">\n                <div className=\"mr-auto\">\n                    <h5 className=\"mb-0 text-secondary\">Memorandums</h5>\n                    <h4 className=\"page-head-title mb-0\">{this.props.institution.name}</h4>\n                </div>\n\n                <div className=\"page-head-actions\">\n                    <Button outline size=\"sm\" color=\"success\" onClick={this.toggleAddMemorandum}>Add a\n                        Memorandum</Button>\n                </div>\n\n                <MemorandumFormModal isOpen={this.state.addMemorandumIsShowing}\n                                     institution={this.props.institution}\n                                     toggle={this.toggleAddMemorandum}\n                                     refresh={this.props.refreshMemorandums}/>\n            </div>\n        );\n    }\n}\n\nclass MemorandumBody extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n\n    render() {\n        return (\n            <div className=\"page-body w-100\">\n                <div className=\"d-flex h-100 p-0 flex-row\">\n                    <div className=\"w-100\">\n                        <MemorandumListSection institution={this.props.institution}\n                                               activeMemorandumId={this.props.activeMemorandumId}\n                                               memorandums={this.props.memorandums.agreements}\n                                               latest={this.props.memorandums.latestMOA}\n                                               setActiveMemorandum={this.props.setActiveMemorandum}\n                                               refreshMemorandums={this.props.refreshMemorandums}>\n                            MOA (Memorandums of Agreement)\n                        </MemorandumListSection>\n\n                        <MemorandumListSection institution={this.props.institution}\n                                               memorandums={this.props.memorandums.understandings}\n                                               latest={this.props.memorandums.latestMOU}\n                                               activeMemorandumId={this.props.activeMemorandumId}\n                                               setActiveMemorandum={this.props.setActiveMemorandum}\n                                               refreshMemorandums={this.props.refreshMemorandums}>\n                            MOU (Memorandums of Understanding)\n                        </MemorandumListSection>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nclass MemorandumListSection extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            deleteMemorandumIsShowing : false,\n            editMemorandumIsShowing : false,\n        };\n\n        this.emptyState = this.emptyState.bind(this);\n        this.toggleDeleteMemorandum = this.toggleDeleteMemorandum.bind(this);\n        this.toggleEditMemorandum = this.toggleEditMemorandum.bind(this);\n    }\n\n    toggleDeleteMemorandum() {\n        this.setState({\n            deleteMemorandumIsShowing : !this.state.deleteMemorandumIsShowing,\n        });\n    }\n\n    toggleEditMemorandum() {\n        this.setState({\n            editMemorandumIsShowing : !this.state.editMemorandumIsShowing,\n        });\n    }\n\n    emptyState() {\n        return (\n            <div className=\"p-5 text-center bg-light\">\n                <h5 className=\"text-secondary\">There are no {this.props.children} for this institution</h5>\n            </div>\n        );\n    }\n\n    render() {\n        if (this.props.memorandums.length === 0) {\n            return (\n                <Section>\n                    <SectionTitle>{this.props.children}</SectionTitle>\n                    {this.emptyState()}\n                </Section>\n            );\n        }\n\n        const rows = this.props.memorandums.map((memorandum, index) => {\n            const onMemorandumRowClick = () => this.props.setActiveMemorandum(memorandum);\n\n            let isActive = false;\n\n            if (this.props.activeMemorandumId !== null) {\n                isActive = this.props.activeMemorandumId === memorandum.id;\n            }\n\n            return <MemorandumRow memorandum={memorandum}\n                                  isActive={isActive}\n                                  onClick={onMemorandumRowClick}\n                                  latest={index === 0}\n                                  key={memorandum.id}/>;\n        });\n\n        return (\n            <div>\n                <Section>\n                    <SectionTitle>{this.props.children}</SectionTitle>\n                    <SectionTable className=\"memorandums-accordion\">\n                        {rows}\n                    </SectionTable>\n                </Section>\n            </div>\n        );\n    }\n}\n\nclass MemorandumRow extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        const memorandum = this.props.memorandum;\n\n        function formatDate(date) {\n            return moment(date).format(\"LL\");\n        }\n\n        const dateEffective = formatDate(memorandum.date_effective);\n        return (\n            <SectionRow selectable\n                        onClick={this.props.onClick}\n                        active={this.props.isActive}>\n                {this.props.latest &&\n                <SectionRowTitle>Latest Memorandum</SectionRowTitle>\n                }\n                <SectionRowContent large>Effective {dateEffective}</SectionRowContent>\n            </SectionRow>\n        );\n    }\n}\n\nexport default Memorandums;"]}