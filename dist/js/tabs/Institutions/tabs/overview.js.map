{"version":3,"sources":["../../../../../js/tabs/Institutions/tabs/overview.js"],"names":["fetchInstitution","id","onResponse","query","InstitutionOverview","props","state","institution","institutionID","onEditInstitution","bind","setState","response","data","nextProps","refreshInstitutions","onDeleteActiveInstitution","OverviewHead","deleteInstitutionIsShowing","editInstitutionIsShowing","toggleEditInstitution","toggleDeleteInstitution","name","onDeleteInstitution","OverviewBody","InstitutionDetails","agreementType","agreement","website","openWebsite","require","shell","openExternal","address","country","ContactDetails","contactPersonName","contactPersonEmail","contactPersonNumber"],"mappings":"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","file":"overview.js","sourcesContent":["import React, { Component } from \"react\";\nimport LoadingSpinner from \"../../../loading\";\nimport graphql from \"../../../graphql\";\n\nimport {\n    Button,\n    ListGroup,\n    ListGroupItem,\n} from \"reactstrap\";\n\nimport {\n    DeleteInstitutionModal,\n    EditInstitutionModal,\n} from \"../modals\";\n\nimport {\n    Section,\n    SectionTitle,\n    SectionTable,\n    SectionRow,\n    SectionRowTitle,\n    SectionRowContentLarge,\n} from \"../../../components/section\";\n\n\nfunction fetchInstitution(id, onResponse) {\n    graphql({\n        query : `\n        {\n            institution(id:${id}) {\n                id\n                name\n                address\n                website\n                contactPersonEmail\n                contactPersonName\n                contactPersonNumber\n                country {\n                    name\n                }\n                agreement\n            }\n        }\n       `,\n        onResponse : onResponse,\n    });\n}\n\nclass InstitutionOverview extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            institution : null,\n            institutionID : props.institution.id,\n        };\n\n        this.onEditInstitution = this.onEditInstitution.bind(this);\n\n        //Fetch active institution details\n        fetchInstitution(props.institution.id, response => {\n            this.setState({\n                institution : response.data.institution,\n            });\n        });\n    }\n\n    componentWillReceiveProps(nextProps) {\n        this.setState({\n            institutionID : nextProps.institution.id,\n            institution : null,\n        });\n\n        fetchInstitution(nextProps.institution.id, response => {\n            this.setState({\n                institution : response.data.institution,\n            });\n        });\n    }\n\n    onEditInstitution() {\n        //Refresh and fetch new data from server\n        this.setState({\n            institution : null,\n        });\n\n        fetchInstitution(this.state.institutionID, response => {\n            const institution = response.data.institution;\n            this.setState({\n                institution : institution,\n            });\n\n            this.props.refreshInstitutions();\n        });\n    }\n\n    render() {\n        //User has already selected, but we haven't fetched it from the database yet\n        if (this.state.institution === null) {\n            return <LoadingSpinner/>;\n        }\n\n        return (\n            <div className=\"d-flex flex-column p-0 h-100\">\n                <OverviewHead institution={this.state.institution}\n                              onDeleteInstitution={this.props.onDeleteActiveInstitution}\n                              onEditInstitution={this.onEditInstitution}/>\n                <OverviewBody institution={this.state.institution}/>\n            </div>\n        );\n    }\n}\n\nclass OverviewHead extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            deleteInstitutionIsShowing : false,\n            editInstitutionIsShowing : false,\n        };\n\n        this.toggleEditInstitution = this.toggleEditInstitution.bind(this);\n        this.toggleDeleteInstitution = this.toggleDeleteInstitution.bind(this);\n    }\n\n    toggleEditInstitution() {\n        this.setState({\n            editInstitutionIsShowing : !this.state.editInstitutionIsShowing,\n        });\n    }\n\n    toggleDeleteInstitution() {\n        this.setState({\n            deleteInstitutionIsShowing : !this.state.deleteInstitutionIsShowing,\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"page-head pt-5 d-flex flex-row align-items-end\">\n                <div className=\"mr-auto\">\n                    <h5 className=\"mb-0 text-secondary\">Overview</h5>\n                    <h4 className=\"page-head-title mb-0\">\n                        {this.props.institution.name}\n                    </h4>\n                </div>\n\n                <div className=\"page-head-actions\">\n                    <Button outline size=\"sm\" color=\"success\" className=\"mr-2\"\n                            onClick={this.toggleEditInstitution}>Edit Institution</Button>\n                    <Button outline size=\"sm\" color=\"danger\"\n                            onClick={this.toggleDeleteInstitution}>Delete</Button>\n                </div>\n\n                <DeleteInstitutionModal isOpen={this.state.deleteInstitutionIsShowing}\n                                        institution={this.props.institution}\n                                        toggle={this.toggleDeleteInstitution}\n                                        refresh={this.props.onDeleteInstitution}/>\n\n                <EditInstitutionModal isOpen={this.state.editInstitutionIsShowing}\n                                      institution={this.props.institution}\n                                      refresh={this.props.onEditInstitution}\n                                      toggle={this.toggleEditInstitution}/>\n\n            </div>\n        );\n    }\n}\n\nclass OverviewBody extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        return (\n            <div className=\"page-body\">\n                <InstitutionDetails institution={this.props.institution}/>\n                <ContactDetails institution={this.props.institution}/>\n            </div>\n        );\n    }\n}\n\nclass InstitutionDetails extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        const institution = this.props.institution;\n        const agreementType = this.props.institution.agreement === \"B\" ? \"Bilateral\" : \"Multilateral\";\n        const website = `http://${institution.website}`;\n\n        function openWebsite() {\n            const { shell } = require(\"electron\");\n            shell.openExternal(website);\n        }\n\n        return (\n            <Section>\n                <SectionTitle>Institution details</SectionTitle>\n                <SectionTable>\n                    <SectionRow>\n                        <SectionRowTitle>Address</SectionRowTitle>\n                        <SectionRowContentLarge>{institution.address}</SectionRowContentLarge>\n                    </SectionRow>\n\n                    <SectionRow>\n                        <SectionRowTitle>Country</SectionRowTitle>\n                        <SectionRowContentLarge>{institution.country.name}</SectionRowContentLarge>\n                    </SectionRow>\n\n                    <SectionRow>\n                        <SectionRowTitle>Website</SectionRowTitle>\n                        <SectionRowContentLarge className=\"text-primary\" onClick={openWebsite}>{website}</SectionRowContentLarge>\n                    </SectionRow>\n\n                    <SectionRow>\n                        <SectionRowTitle>Agreement Type</SectionRowTitle>\n                        <SectionRowContentLarge>{agreementType}</SectionRowContentLarge>\n                    </SectionRow>\n                </SectionTable>\n            </Section>\n        );\n    }\n}\n\nclass ContactDetails extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        const institution = this.props.institution;\n\n        return (\n            <Section>\n                <SectionTitle>Contact Details</SectionTitle>\n                <SectionTable>\n                    <SectionRow>\n                        <SectionRowTitle>Contact Person</SectionRowTitle>\n                        <SectionRowContentLarge>{institution.contactPersonName}</SectionRowContentLarge>\n                    </SectionRow>\n                    <SectionRow>\n                        <SectionRowTitle>Contact Person Email</SectionRowTitle>\n                        <SectionRowContentLarge>{institution.contactPersonEmail}</SectionRowContentLarge>\n                    </SectionRow>\n                    <SectionRow>\n                        <SectionRowTitle>Contact Person Number</SectionRowTitle>\n                        <SectionRowContentLarge>{institution.contactPersonNumber}</SectionRowContentLarge>\n                    </SectionRow>\n                </SectionTable>\n            </Section>\n        );\n    }\n}\n\n\nexport default InstitutionOverview;"]}