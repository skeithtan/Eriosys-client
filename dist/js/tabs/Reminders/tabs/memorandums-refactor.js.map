{"version":3,"sources":["../../../../../js/tabs/Reminders/tabs/memorandums-refactor.js"],"names":["fetchInstitutions","onResult","query","then","makeMemorandumInfo","memorandumType","institution","memorandum","name","id","type","dateEffective","date_effective","dateExpiration","date_expiration","makeMemorandumsFromInstitutions","institutions","memorandums","forEach","latest_mou","push","latest_moa","sort","a","b","diff","Memorandums","props","state","activeCategory","activeMemorandum","setState","result","setMemorandums","bind","setActiveMemorandum","category","filteredMemorandums","MemorandumsHead","onCategoryChange","event","target","value","MemorandumsBody","emptyState","MemorandumRow"],"mappings":"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","file":"memorandums-refactor.js","sourcesContent":["import React, { Component } from \"react\";\nimport graphql from \"../../../graphql\";\nimport moment from \"moment\";\nimport settings from \"../../../settings\";\nimport LoadingSpinner from \"../../../components/loading\";\nimport {\n    SectionRow,\n    SectionRowContent,\n} from \"../../../components/section\";\nimport {\n    Input,\n} from \"reactstrap\";\nimport { MemorandumFormModal } from \"../../Institutions/modals\";\n\nfunction fetchInstitutions(onResult) {\n    graphql.query(`\n    {\n        institutions {\n            id\n            name\n            latest_moa {\n                id\n                date_effective\n                date_expiration\n            }\n            latest_mou {\n                id\n                date_effective\n                date_expiration\n            }\n        }\n    }\n    `).then(onResult);\n}\n\nfunction makeMemorandumInfo(memorandumType, institution, memorandum) {\n    return {\n        institution : {\n            name : institution.name,\n            id : institution.id,\n        },\n        memorandum : {\n            id : memorandum.id,\n            type : memorandumType,\n            dateEffective : moment(memorandum.date_effective),\n            dateExpiration : moment(memorandum.date_expiration),\n        },\n    };\n}\n\nfunction makeMemorandumsFromInstitutions(institutions) {\n    let memorandums = [];\n\n\n    institutions.forEach(institution => {\n        if (institution.latest_mou !== null && institution.latest_mou.date_expiration !== null) {\n            memorandums.push(makeMemorandumInfo(\"Understanding\", institution, institution.latest_mou));\n        }\n\n        if (institution.latest_moa !== null && institution.latest_moa.date_expiration !== null) {\n            memorandums.push(makeMemorandumInfo(\"Agreement\", institution, institution.latest_moa));\n        }\n    });\n\n    memorandums.sort((a, b) => {\n        return a.memorandum.dateExpiration.diff(b.memorandum.dateExpiration);\n    });\n\n    return memorandums;\n}\n\nclass Memorandums extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            activeCategory : \"Agreement\",\n            institutions : null,\n            activeMemorandum : null,\n        };\n\n        fetchInstitutions(result => {\n            this.setState({\n                institutions : result.institutions,\n            });\n        });\n\n        this.setMemorandums = this.setMemorandums.bind(this);\n        this.setActiveMemorandum = this.setActiveMemorandum.bind(this);\n    }\n\n    setMemorandums(category) {\n        let filteredMemorandums = [];\n\n        const institutions = this.state.institutions;\n\n        if (institutions !== null) {\n            const memorandums = makeMemorandumsFromInstitutions(institutions);\n\n            memorandums.forEach(memorandum => {\n                if (memorandum.memorandum.type === category) {\n                    filteredMemorandums.push(memorandum);\n                }\n            });\n        }\n\n        return filteredMemorandums;\n    }\n\n    setActiveMemorandum(memorandum) {\n        // TODO\n    }\n\n    render() {\n        const memorandums = this.setMemorandums(this.state.activeCategory);\n\n        return (\n            <div className=\"d-flex flex-column h-100\">\n                <MemorandumsHead setMemorandums={ this.setMemorandums }/>\n                <MemorandumsBody activeCategory={ this.state.activeCategory }\n                                 memorandums={ memorandums }/>\n            </div>\n        );\n    }\n}\n\nclass MemorandumsHead extends Component {\n    constructor(props) {\n        super(props);\n\n        this.onCategoryChange = this.onCategoryChange.bind(this);\n    }\n\n    onCategoryChange(event) {\n        this.props.setMemorandums(event.target.value);\n    }\n\n    render() {\n        return (\n            <div className=\"page-head pt-5 d-flex flex-row align-items-end\">\n                <div className=\"mr-auto\">\n                    <h4 className=\"page-head-title justify-content-left d-inline-block mb-0 mr-2\">\n                        Memorandum Reminders\n                    </h4>\n                </div>\n                <div className=\"page-head-actions\">\n                    <Input type=\"select\"\n                           className=\"btn-outline-success\"\n                           defaultValue=\"MOA\"\n                           onChange={ this.onCategoryChange }>\n                        <option value=\"Agreement\">Agreement</option>\n                        <option value=\"Understanding\">Understanding</option>\n                    </Input>\n                </div>\n            </div>\n        );\n    }\n}\n\nclass MemorandumsBody extends Component {\n    constructor(props) {\n        super(props);\n\n        this.emptyState = this.emptyState.bind(this);\n    }\n\n    emptyState() {\n        return (\n            <div className=\"loading-container\">\n                <h3>There are no expiring Memorandums of { this.props.activeCategory }</h3>\n            </div>\n        );\n    }\n\n    render() {\n        const memorandums = this.props.memorandums;\n\n        return (\n            <div>\n                \n            </div>\n        );\n    }\n}\n\nclass MemorandumRow extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n\n    }\n}\n\nexport default Memorandums;"]}